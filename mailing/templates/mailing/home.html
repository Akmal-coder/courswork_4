<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .stats {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
        }
        .stat-card {
            flex: 1;
            padding: 20px;
            margin: 0 10px;
            background: #f9f9f9;
            border-radius: 5px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #4CAF50;
        }
        .stat-label {
            color: #666;
            margin-top: 10px;
        }
        .nav-links {
            margin-top: 30px;
            text-align: center;
        }
        .nav-links a {
            display: inline-block;
            margin: 0 10px;
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .nav-links a:hover {
            background: #45a049;
        }
        .auth-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            text-align: center;
        }
        .logout-form {
            display: inline-block;
            margin-left: 10px;
        }
        .logout-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
        }
        .login-btn {
            background: #2196F3;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
        }
        .restricted-message {
            color: #666;
            padding: 10px 20px;
            background: #fff3e0;
            border-radius: 4px;
            margin: 10px 0;
        }
        .cache-info {
            margin-top: 20px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            font-size: 0.9em;
            color: #666;
            text-align: center;
        }
        .profile-btn {
            background: #9C27B0;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
            display: inline-block;
            margin-left: 10px;
        }
        .user-groups {
            background: #e3f2fd;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-left: 10px;
        }
        .manager-badge {
            background: #ff9800;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å—Å—ã–ª–æ–∫</h1>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">{{ total_mailings }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞—Å—Å—ã–ª–æ–∫</div>
            </div>

            <div class="stat-card">
                <div class="stat-number">{{ active_mailings }}</div>
                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫</div>
            </div>

            <div class="stat-card">
                <div class="stat-number">{{ unique_clients }}</div>
                <div class="stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
            </div>
        </div>

        <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ö–ï–®–ò–†–û–í–ê–ù–ò–ò -->
        <div class="cache-info">
            <small>
                ‚ö° –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à–∏—Ä—É–µ—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.
                {% if user.is_authenticated and user.is_superuser %}
                    <br>üëë <strong>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</strong> –∫–µ—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
                {% endif %}
            </small>
        </div>

        <div class="nav-links">
            <a href="/admin/">‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>

            {% if user.is_authenticated %}
                <!-- –≠—Ç–∏ —Å—Å—ã–ª–∫–∏ –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º -->
                <a href="{% url 'client_list' %}">üë§ –ö–ª–∏–µ–Ω—Ç—ã</a>
                <a href="{% url 'message_list' %}">üì® –°–æ–æ–±—â–µ–Ω–∏—è</a>
                <a href="{% url 'mailing_list' %}">üìß –†–∞—Å—Å—ã–ª–∫–∏</a>
                <a href="{% url 'mailing_create' %}">‚ûï –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</a>
            {% else %}
                <!-- –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—è—Å–Ω–µ–Ω–∏–µ -->
                <span class="restricted-message">
                    üîí –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª–∏–µ–Ω—Ç–∞–º –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º –Ω—É–∂–Ω–æ –≤–æ–π—Ç–∏
                </span>
            {% endif %}
        </div>

        <div class="auth-section">
            {% if user.is_authenticated %}
                <span>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong>{{ user.username }}</strong></span>

                {% if user.groups.all %}
                    <span class="user-groups">
                        –ì—Ä—É–ø–ø—ã:
                        {% for group in user.groups.all %}
                            {{ group.name }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </span>
                {% endif %}

                {% if user.is_superuser %}
                    <span class="manager-badge">üëë –ê–¥–º–∏–Ω</span>
                {% elif user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' %}
                    <span class="manager-badge">‚ö° –ú–µ–Ω–µ–¥–∂–µ—Ä</span>
                {% endif %}

                <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å -->
                <a href="{% url 'profile' %}" class="profile-btn">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>

                <!-- –§–û–†–ú–ê –î–õ–Ø –í–´–•–û–î–ê -->
                <form method="post" action="{% url 'logout' %}" class="logout-form">
                    {% csrf_token %}
                    <button type="submit" class="logout-btn">üö™ –í—ã–π—Ç–∏</button>
                </form>
            {% else %}
                <a href="{% url 'login' %}" class="login-btn">üîê –í–æ–π—Ç–∏</a>
                <a href="{% url 'profile' %}" class="profile-btn">üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            {% endif %}
        </div>
    </div>
</body>
</html>