<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤</title>
    <style>
        body { font-family: Arial; max-width: 1000px; margin: 40px auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .btn { padding: 10px 15px; background: #4CAF50; color: white; text-decoration: none; border-radius: 4px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:hover { background-color: #f5f5f5; }
        .actions a { margin-right: 10px; color: #2196F3; }
        .owner-info { font-size: 0.9em; color: #666; margin-top: 5px; }
        .manager-badge { background: #ff9800; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìã –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤</h1>
        <a href="{% url 'client_create' %}" class="btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö -->
    <div style="margin: 10px 0; padding: 10px; background: #f0f8ff; border-radius: 4px; font-size: 0.9em;">
        {% if user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' or user.is_superuser %}
            <span class="manager-badge">‚ö° –ú–µ–Ω–µ–¥–∂–µ—Ä</span> –í—ã –≤–∏–¥–∏—Ç–µ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã
        {% else %}
            –í—ã –≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
        {% endif %}
    </div>

    <table>
        <thead>
            <tr>
                <th>–§–ò–û</th>
                <th>Email</th>
                <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for client in clients %}
            <tr>
                <td>
                    {{ client.full_name }}
                    <div class="owner-info">
                        {% if client.owner == user %}
                            <em>–í–∞—à –∫–ª–∏–µ–Ω—Ç</em>
                        {% elif user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' or user.is_superuser %}
                            –í–ª–∞–¥–µ–ª–µ—Ü: {{ client.owner.username }}
                        {% endif %}
                    </div>
                </td>
                <td>{{ client.email }}</td>
                <td>{{ client.comment|truncatechars:50 }}</td>
                <td class="actions">
                    <a href="{% url 'client_detail' client.pk %}">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</a>

                    <!-- –ü–†–û–í–ï–†–ö–ê –ü–†–ê–í: —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –∏–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª—è—Ç—å -->
                    {% if client.owner == user or user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' or user.is_superuser %}
                        <a href="{% url 'client_update' client.pk %}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="{% url 'client_delete' client.pk %}" style="color: #f44336;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
                    {% else %}
                        <span style="color: #999; font-size: 0.9em;">–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center;">–ö–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="margin-top: 20px;">
        <a href="{% url 'home' %}">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
</body>
</html>