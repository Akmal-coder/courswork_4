<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>
        {% if object %}
            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
        {% else %}
            –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
        {% endif %}
    </title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 40px auto; padding: 20px; }
        .form-container { background: #f9f9f9; padding: 20px; border-radius: 8px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; }
        input[type="text"], input[type="email"], textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea { min-height: 100px; }
        .btn {
            padding: 12px 20px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn-cancel {
            background: #f44336;
            margin-left: 10px;
        }
        .btn:hover { opacity: 0.9; }
        .help-text { color: #666; font-size: 0.9em; margin-top: 5px; }
        .error { color: #f44336; font-size: 0.9em; margin-top: 5px; }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px; }
        .checkbox-item { display: flex; align-items: center; }
        .checkbox-item input { margin-right: 8px; }
    </style>
</head>
<body>
    <h1>
        {% if object %}
            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
        {% else %}
            üìß –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
        {% endif %}
    </h1>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∞–≤–∞—Ö -->
    {% if user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' or user.is_superuser %}
        <div style="margin: 10px 0; padding: 10px; background: #fff3cd; border-radius: 4px; font-size: 0.9em;">
            ‚ö° <strong>–†–µ–∂–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞:</strong> –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫–∏ –¥–ª—è –ª—é–±—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        </div>
    {% endif %}

    <div class="form-container">
        <form method="post">
            {% csrf_token %}

            <div class="form-group">
                <label for="id_name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏ *</label>
                {{ form.name }}
                {% if form.name.errors %}
                    <div class="error">{{ form.name.errors }}</div>
                {% endif %}
                <div class="help-text">–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏</div>
            </div>

            <div class="form-group">
                <label for="id_message">–°–æ–æ–±—â–µ–Ω–∏–µ *</label>
                {{ form.message }}
                {% if form.message.errors %}
                    <div class="error">{{ form.message.errors }}</div>
                {% endif %}
                <div class="help-text">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞</div>
            </div>

            <div class="form-group">
                <label>–ö–ª–∏–µ–Ω—Ç—ã *</label>
                <div class="help-text">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                <div class="checkbox-group">
                    {{ form.clients }}
                </div>
                {% if form.clients.errors %}
                    <div class="error">{{ form.clients.errors }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="id_frequency">–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å *</label>
                {{ form.frequency }}
                {% if form.frequency.errors %}
                    <div class="error">{{ form.frequency.errors }}</div>
                {% endif %}
                <div class="help-text">–ö–∞–∫ —á–∞—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</div>
            </div>

            <div class="form-group">
                <label for="id_status">–°—Ç–∞—Ç—É—Å</label>
                {{ form.status }}
                {% if form.status.errors %}
                    <div class="error">{{ form.status.errors }}</div>
                {% endif %}
                <div class="help-text">"–ó–∞–ø—É—â–µ–Ω–∞" - —Ä–∞—Å—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é</div>
            </div>

            <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è) -->
            {% if not object %}
                {% if user.groups.all.0.name == '–ú–µ–Ω–µ–¥–∂–µ—Ä—ã' or user.is_superuser %}
                <div class="form-group">
                    <label for="id_owner">–í–ª–∞–¥–µ–ª–µ—Ü (–¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)</label>
                    {{ form.owner }}
                    <div class="help-text">–ú–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ä–∞—Å—Å—ã–ª–∫–∏</div>
                </div>
                {% else %}
                    <input type="hidden" name="owner" value="{{ user.id }}">
                {% endif %}
            {% endif %}

            <div style="margin-top: 30px; display: flex; gap: 10px;">
                <button type="submit" class="btn">
                    {% if object %}
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    {% else %}
                        –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
                    {% endif %}
                </button>
                <a href="{% url 'mailing_list' %}" class="btn btn-cancel">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>

    <div style="margin-top: 30px;">
        <a href="{% url 'mailing_list' %}">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —Ä–∞—Å—Å—ã–ª–æ–∫</a> |
        <a href="{% url 'home' %}">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>

    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤
        document.addEventListener('DOMContentLoaded', function() {
            const clientsDiv = document.querySelector('#id_clients');
            if (clientsDiv) {
                const checkboxes = clientsDiv.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach((checkbox, index) => {
                    const label = document.createElement('label');
                    label.className = 'checkbox-item';
                    label.appendChild(checkbox);

                    const text = document.createElement('span');
                    text.textContent = checkbox.nextSibling.textContent;
                    label.appendChild(text);

                    checkbox.style.marginRight = '8px';
                    clientsDiv.appendChild(label);
                    clientsDiv.appendChild(document.createElement('br'));
                });
            }
        });
    </script>
</body>
</html>